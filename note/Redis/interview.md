

**缓存穿透，雪崩，击穿**

穿透：访问的key在redis和数据库中都没有，导致每次都从缓存中找不到而去查数据库。若黑客利用此漏洞进行攻击可能压垮数据库。

击穿：一个key过期，此时大量请求来访问这个key就会都去请求DB，而打垮DB

雪崩：当重启等造成大量key同事失效，大量请求取访问DB从而打垮DB



**解决方案**

***穿透***

1. 布隆过滤器
2. 查不到的也进行缓存，使它不去在查DB

***击穿***

1. 使用互斥锁

当缓存失效时，首先不是去查DB，而是只要一个线程需查DB，其他线程尝试获得缓存。最常见的就是通过一个setnx(此key不存在才会赋值成功)，每个线程都setnx，所以只有一个线程能set这个key，只有setkey成功的线程才取查询DB，然后缓存，其他线程都尝试读取。

伪代码：

```java
public String get(key) {
  String value = redis.get(key);
  // 缓存过期
  if (value == null) { 
    //设置3min的ttl,赋值成功相当于拿到锁了
    if (redis.setnx(key_mutex, 1, 3 * 60) == 1) {  
      value = db.get(key);
      redis.set(key, value, expire_secs);
      redis.del(key_mutex);
    } else {  
      // 没拿到锁的，重试获取缓存值
      sleep(50);
      get(key);
    }
  } else {
    return value;      
  }
}

```

***雪崩***

为了防止大片key失效从而打挂DB，需要使过期时间分散开

1. 过期时间添加随机值





**redis的六中淘汰策略**



**如何限制每分钟客户发送验证码的个数**



**redis是单线程，单进程的？**



**redis的并发竞争关系如何解决**





# Basic



**reids如何设置密码**



**redis中的管道有什么用**



**如何做大量数据插入**



**怎么设置redis的过期时间和永久有效**



**redis的Java客户端**



**jedis与detission的区别**



**redis回收进程如何工作**



**redis为什么要将数据放在内存中**

为了快速读写和异步写入磁盘，如果不在内存中，磁盘I/O回严重影响redis性能



**字符串类型的value最大容量**

512M，其他的是(2^32)-1个



**redis持久化的几种方式，优缺点**







**redis的同步机制**



**内存用完后redis会怎么办**

1. 当内存达到限制时返回错误
2. 尝试回收最少使用的key(LRU)
3. 尝试回收过期key中最少使用的key(LRU)
4. 随机回收一个
5. 过期的key中随机回收一个
6. 过期的key回收存活时间短的



**过期键的删除策略**



**一个redis实例可以有多少key，五种数据类型他们能放多少元素**



**怎么使用redis做异步队列**



**为什么要做redis分区**



**redis分区的实现方案**



**redis分区的缺点**



**持久化数据和缓存怎么做扩容**



**twemproxy是什么**



**支持一致性hash的客户端**



**修改配置不重启会生效吗**



**为什么redis要是单线程的**



**redis是单线程的为什么还这么快**



**redis的内存模型**



**进程本身需要的内存**



**缓冲内存**



**内存碎片**



**持久化触发条件**



**开启AOF**



**AOF常用配置**



**持久化策略的选择**



**布隆过滤器**



**redis的通信协议**



**scan命令系列的注意条件**



**常见的几种缓存策略**





# 事务





**redis事务，CAS乐观锁**



**watch命令和基于CAS的乐观锁**



**redis事务相关的命令**







# 集群



**redis集群都有哪些方案**





**分布式是前期做好，还是规模上来后再做好**



**什么情况下会导致集群不可用**

在没有复制模型的情况下，如果一个节点失败了，则hash槽就不完整了，从而不可用



**读写分离模型**



**数据分片模型**



**redis哨兵**



**redis集群的主从复制模型**



**redis集群会有写丢失吗？**



**redis集群之间如何复制**



**redis集群的最大节点个数**



**redis集群如何选择数据库**



**怎么测试redis的连通性**



**redis哈希槽的概念**



**redis分布式锁的实现**





# 优化



**redis如何做内存优化**



**redis常见性能问题与解决方案**



**降低内存使用情况的做法**



**redis是单线程的，则呢么提高多核cpu利用率**



**手写LRU算法**



# 锁



**redis分布式锁怎么实现**



**如何实现集群中的session共享**



**多节点分布式锁Redlock算法**



**redis实现附近的人**



**MySQL中存100w数据，Redis中存20w数据，如何保证redis中存的都是热点数据**

redis的淘汰策略



**redis的使用场景**

* 会话缓存
* 队列
* 排行榜/计数器
* 发布订阅





